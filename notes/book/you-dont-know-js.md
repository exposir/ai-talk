# ä½ ä¸çŸ¥é“çš„ JavaScript

> "å¯¹äºä½ ä¸äº†è§£çš„ä¸œè¥¿ï¼Œä½ æ— æ³•çœŸæ­£æ‹¥æœ‰å®ƒã€‚" â€”â€” Kyle Simpson

ã€ŠYou Don't Know
JSã€‹ç³»åˆ—ä¸›ä¹¦çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹æ•´ç†ï¼Œåˆ†ä¸ºä¸Šå·ï¼ˆä½œç”¨åŸŸ/é—­åŒ…ã€this/åŸå‹ï¼‰ã€ä¸­å·ï¼ˆç±»å‹/è¯­æ³•ã€å¼‚æ­¥/æ€§èƒ½ï¼‰ã€ä¸‹å·ï¼ˆES6+ï¼‰ã€‚

## ğŸ“… 2026 å¹´ç°ä»£é€‚ç”¨æ€§è¯´æ˜

æœ¬ä¹¦å†™äº ES6 æ—¶ä»£ï¼Œå¯¹äºä½¿ç”¨ Vue/React/TypeScript çš„ç°ä»£å‰ç«¯å¼€å‘è€…ï¼Œä»¥ä¸‹æ˜¯é˜…è¯»ä¼˜å…ˆçº§å»ºè®®ï¼š

### âœ… ä»ç„¶æ ¸å¿ƒé‡è¦

| å†…å®¹                    | ç°ä»£åœºæ™¯                                     | é‡è¦æ€§ |
| ----------------------- | -------------------------------------------- | ------ |
| **é—­åŒ…**                | React Hooks æœ¬è´¨æ˜¯é—­åŒ…ï¼Œç†è§£é—­åŒ…é™·é˜±è‡³å…³é‡è¦ | â­â­â­ |
| **this ç»‘å®š**           | Vue Options APIã€Class ç»„ä»¶ã€äº‹ä»¶å¤„ç†        | â­â­â­ |
| **Promise/async-await** | æ—¥å¸¸å¼€å‘å¿…å¤‡ï¼Œç†è§£å¾®ä»»åŠ¡æ‰§è¡Œæ—¶æœº             | â­â­â­ |
| **Proxy**               | Vue 3 å“åº”å¼æ ¸å¿ƒåŸç†                         | â­â­â­ |
| **å¾®ä»»åŠ¡/å®ä»»åŠ¡**       | ç†è§£ Vue `nextTick`ã€React æ‰¹é‡æ›´æ–°æ—¶æœº      | â­â­â­ |
| **åŸå‹é“¾**              | ç†è§£æ¡†æ¶æºç ã€åº“ç»§æ‰¿æ¨¡å¼                     | â­â­   |
| **æŠ½è±¡æ“ä½œ/ç±»å‹è½¬æ¢**   | è°ƒè¯• TypeScript è¾¹ç•Œé—®é¢˜                     | â­â­   |

### âš ï¸ å¯ä»¥ç•¥è¯»

| å†…å®¹           | åŸå›                                           |
| -------------- | --------------------------------------------- |
| IIFE æ¨¡å—æ¨¡å¼  | ES Modules å·²æˆæ ‡å‡†ï¼ŒVite/Webpack è‡ªåŠ¨å¤„ç†    |
| Generator      | å‡ ä¹ä¸ç›´æ¥ä½¿ç”¨ï¼Œasync/await å·²æ›¿ä»£            |
| `var` vs `let` | ç°ä»£ä»£ç åªç”¨ `let/const`ï¼ŒESLint ä¼šç¦æ­¢ `var` |
| å›è°ƒåœ°ç‹±è¯¦è§£   | async/await å·²å½»åº•è§£å†³                        |
| `with`/`eval`  | ä¸¥æ ¼æ¨¡å¼å’Œ CSP å·²ç¦ç”¨                         |

### âŒ éœ€è¦é¢å¤–è¡¥å……å­¦ä¹ 

| ä¸»é¢˜                      | è¯´æ˜                                         | æ¨èèµ„æº                         |
| ------------------------- | -------------------------------------------- | -------------------------------- |
| **TypeScript**            | 2026 å¹´å‡ ä¹æ˜¯æ ‡é…                            | å®˜æ–¹æ–‡æ¡£ã€Type Challenges        |
| **React Hooks åŸç†**      | é—­åŒ…é™·é˜±ã€ä¾èµ–æ•°ç»„ã€Fiber æ¶æ„               | React å®˜æ–¹æ–‡æ¡£ã€Dan Abramov åšå®¢ |
| **Vue 3 Composition API** | `ref`/`reactive` å“åº”å¼åŸç†                  | Vue å®˜æ–¹æ–‡æ¡£                     |
| **Signals**               | æ–°ä¸€ä»£å“åº”å¼èŒƒå¼ (Solid, Vue Vapor, Angular) | å„æ¡†æ¶å®˜æ–¹æ–‡æ¡£                   |
| **Server Components**     | React 19+ æœåŠ¡ç«¯ç»„ä»¶                         | Next.js æ–‡æ¡£                     |

> **æ€»ç»“**ï¼šæœ¬ä¹¦çº¦ 60% å†…å®¹ä»æ˜¯ JS åº•å±‚æ ¸å¿ƒï¼Œç†è§£å®ƒä»¬èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°è°ƒè¯•é—®é¢˜å’Œç†è§£æ¡†æ¶åŸç†ã€‚ä½†ç°ä»£å¼€å‘è¿˜éœ€è¡¥å…… TypeScript å’Œæ¡†æ¶ç‰¹å®šçŸ¥è¯†ã€‚

---

## ä¸€ã€ä½œç”¨åŸŸä¸é—­åŒ… â­â­â­

**æ ¸å¿ƒè§‚ç‚¹**ï¼šJavaScript æ˜¯ä¸€é—¨ç¼–è¯‘è¯­è¨€ï¼Œæ‰€æœ‰çš„"å‘"åœ¨ä»£ç æ‰§è¡Œå‰çš„å‡ å¾®ç§’å°±å·²åŸ‹ä¸‹ã€‚

### 1.1 å¹•åä¸‰å·¨å¤´ â­â­

| è§’è‰²                  | èŒè´£                                           |
| --------------------- | ---------------------------------------------- |
| **å¼•æ“ (Engine)**     | æ€»æŒ‡æŒ¥ï¼Œè´Ÿè´£ç¨‹åºçš„æ•´ä¸ªç¼–è¯‘æ‰§è¡Œè¿‡ç¨‹             |
| **ç¼–è¯‘å™¨ (Compiler)** | è´Ÿè´£åˆ†è¯ã€è§£æå’Œä»£ç ç”Ÿæˆ                       |
| **ä½œç”¨åŸŸ (Scope)**    | ç»´æŠ¤å˜é‡çš„"æˆ·ç±è´¦æœ¬"ï¼Œè§„å®šä»£ç å¯¹å˜é‡çš„è®¿é—®æƒé™ |

#### `var a = 2;` å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

```
ç¼–è¯‘æœŸï¼šç¼–è¯‘å™¨é—®ä½œç”¨åŸŸ"è§è¿‡ a å—ï¼Ÿ" â†’ æ²¡æœ‰åˆ™å£°æ˜æ–°å˜é‡
æ‰§è¡ŒæœŸï¼šå¼•æ“é—®ä½œç”¨åŸŸ"èƒ½æ‰¾åˆ° a å—ï¼Ÿ" â†’ æ‰¾åˆ°åˆ™èµ‹å€¼ 2
```

### 1.2 LHS ä¸ RHS æŸ¥è¯¢ â­â­

| ç±»å‹                      | å«ä¹‰                              | æ‰¾ä¸åˆ°æ—¶çš„è¡Œä¸º           |
| ------------------------- | --------------------------------- | ------------------------ |
| **LHS** (Left-hand Side)  | æ‰¾å˜é‡å®¹å™¨ä»¥ä¾¿èµ‹å€¼ï¼Œå¦‚ `a = 2`    | éä¸¥æ ¼æ¨¡å¼ï¼šåˆ›å»ºå…¨å±€å˜é‡ |
| **RHS** (Right-hand Side) | æ‰¾å˜é‡çš„æºå€¼ï¼Œå¦‚ `console.log(a)` | æŠ›å‡º `ReferenceError`    |

### 1.3 è¯æ³•ä½œç”¨åŸŸ â­â­â­

- **å®šä¹‰**ï¼šä½œç”¨åŸŸç”±ä»£ç **ä¹¦å†™ä½ç½®**å†³å®šï¼ˆé™æ€ï¼‰
- **é®è”½æ•ˆåº”**ï¼šæŸ¥æ‰¾ä¼šåœ¨æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…æ ‡è¯†ç¬¦æ—¶åœæ­¢ï¼Œå†…éƒ¨å˜é‡é®è”½å¤–éƒ¨åŒåå˜é‡
- **æ¬ºéª—è¯æ³•**ï¼š`eval()` å’Œ `with` å¯åŠ¨æ€ä¿®æ”¹ä½œç”¨åŸŸï¼Œä½†ä¼šå¯¼è‡´å¼•æ“æ— æ³•ä¼˜åŒ–æ€§èƒ½

### 1.4 å˜é‡æå‡ (Hoisting) â­â­â­

```javascript
a = 2;
var a;
console.log(a); // è¾“å‡º 2ï¼Œè€Œé undefined
```

**è§„åˆ™**ï¼š

- å˜é‡å£°æ˜æå‡ï¼Œèµ‹å€¼ä¸æå‡
- å‡½æ•°å£°æ˜ä¼˜å…ˆçº§é«˜äºå˜é‡å£°æ˜

### 1.5 é—­åŒ… â­â­â­

> **å®šä¹‰**ï¼šå½“å‡½æ•°å¯ä»¥è®°ä½å¹¶è®¿é—®æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸæ—¶ï¼Œå°±äº§ç”Ÿäº†é—­åŒ…ï¼Œå³ä½¿å‡½æ•°æ˜¯åœ¨å½“å‰è¯æ³•ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œã€‚

**æœ¬è´¨**ï¼šé—­åŒ…é˜»æ­¢åƒåœ¾å›æ”¶æœºåˆ¶é”€æ¯å…¶ä¾èµ–çš„è¯æ³•ä½œç”¨åŸŸã€‚

#### ç»å…¸é™·é˜±ï¼šå¾ªç¯ä¸­çš„é—­åŒ…

```javascript
// é—®é¢˜ï¼šå…¨éƒ¨è¾“å‡º 6
for (var i = 1; i <= 5; i++) {
  setTimeout(() => console.log(i), i * 1000);
}

// è§£å†³ï¼šä½¿ç”¨ letï¼ˆæ¯æ¬¡è¿­ä»£åˆ›å»ºæ–°çš„å—çº§ä½œç”¨åŸŸï¼‰
for (let i = 1; i <= 5; i++) {
  setTimeout(() => console.log(i), i * 1000);
}
```

### 1.6 æ¨¡å—æ¨¡å¼ â­â­â­

åˆ©ç”¨é—­åŒ…å®ç°ç§æœ‰å˜é‡å’Œå…¬å…± APIï¼š

#### IIFE æ¨¡å—æ¨¡å¼

```javascript
const MyModule = (function () {
  // ç§æœ‰å˜é‡
  let privateVar = 0;

  // ç§æœ‰å‡½æ•°
  function privateMethod() {
    return privateVar++;
  }

  // å…¬å…± API
  return {
    increment: function () {
      return privateMethod();
    },
    getValue: function () {
      return privateVar;
    },
  };
})();

MyModule.increment(); // 0
MyModule.getValue(); // 1
```

#### ES6 æ¨¡å—

```javascript
// module.js
let privateVar = 0;
export function increment() {
  return privateVar++;
}
export function getValue() {
  return privateVar;
}

// main.js
import { increment, getValue } from './module.js';
```

---

## äºŒã€this ä¸åŸå‹ â­â­â­

**æ ¸å¿ƒè§‚ç‚¹**ï¼š`this` æ˜¯åŠ¨æ€çš„ï¼ˆçœ‹è°ƒç”¨ä½ç½®ï¼‰ï¼Œä¸ä½œç”¨åŸŸï¼ˆçœ‹å®šä¹‰ä½ç½®ï¼‰å½¢æˆå¯¹æ¯”ã€‚

### 2.1 this ç»‘å®šè§„åˆ™ â­â­â­

**ä¼˜å…ˆçº§ç”±ä½åˆ°é«˜ï¼š**

| è§„åˆ™         | åœºæ™¯              | `this` æŒ‡å‘                               |
| ------------ | ----------------- | ----------------------------------------- |
| **é»˜è®¤ç»‘å®š** | `foo()`           | éä¸¥æ ¼æ¨¡å¼ `window`ï¼Œä¸¥æ ¼æ¨¡å¼ `undefined` |
| **éšå¼ç»‘å®š** | `obj.foo()`       | `obj`                                     |
| **æ˜¾å¼ç»‘å®š** | `call/apply/bind` | æŒ‡å®šçš„å¯¹è±¡                                |
| **new ç»‘å®š** | `new Foo()`       | æ–°åˆ›å»ºçš„ç©ºå¯¹è±¡                            |

**éšå¼ä¸¢å¤±é™·é˜±**ï¼š

```javascript
var bar = obj.foo; // bar åªæ˜¯å‡½æ•°å¼•ç”¨
bar(); // é€€åŒ–ä¸ºé»˜è®¤ç»‘å®š
```

**ç®­å¤´å‡½æ•°**ï¼šä¸é€‚ç”¨ä»¥ä¸Šè§„åˆ™ï¼Œ`this` ç»§æ‰¿è‡ªå¤–å±‚è¯æ³•ä½œç”¨åŸŸã€‚

### 2.2 å¯¹è±¡å±æ€§ â­â­

#### å±æ€§æè¿°ç¬¦

é€šè¿‡ `Object.defineProperty` æ§åˆ¶å±æ€§è¡Œä¸ºï¼š

```javascript
Object.defineProperty(obj, 'a', {
  value: 2,
  writable: false, // ä¸å¯ä¿®æ”¹
  configurable: false, // ä¸å¯åˆ é™¤/é‡æ–°é…ç½®
  enumerable: true, // å¯è¢« for...in æšä¸¾
});
```

| æè¿°ç¬¦         | ä½œç”¨                                        |
| -------------- | ------------------------------------------- |
| `writable`     | æ˜¯å¦å¯ä¿®æ”¹å€¼                                |
| `configurable` | æ˜¯å¦å¯åˆ é™¤å±æ€§æˆ–é‡æ–°é…ç½®æè¿°ç¬¦              |
| `enumerable`   | æ˜¯å¦å‡ºç°åœ¨ `for...in` å’Œ `Object.keys()` ä¸­ |

#### Getter/Setter

å®šä¹‰"ä¼ªå±æ€§"ï¼Œåœ¨è¯»å–/èµ‹å€¼æ—¶è§¦å‘å‡½æ•°ï¼š

```javascript
const obj = {
  get a() {
    return this._a * 2;
  },
  set a(val) {
    this._a = val;
  },
};
obj.a = 5; // è°ƒç”¨ setter
console.log(obj.a); // 10ï¼Œè°ƒç”¨ getter
```

#### å¯¹è±¡ä¸å¯å˜æ€§ â­â­

| æ–¹æ³•                            | æ•ˆæœ                                                                |
| ------------------------------- | ------------------------------------------------------------------- |
| `Object.preventExtensions(obj)` | ç¦æ­¢æ·»åŠ æ–°å±æ€§                                                      |
| `Object.seal(obj)`              | ç¦æ­¢æ·»åŠ /åˆ é™¤å±æ€§ï¼ˆç›¸å½“äº preventExtensions + configurable: falseï¼‰ |
| `Object.freeze(obj)`            | å®Œå…¨å†»ç»“ï¼ˆç›¸å½“äº seal + writable: falseï¼‰                           |

```javascript
const obj = { a: 1 };
Object.freeze(obj);
obj.a = 2; // é™é»˜å¤±è´¥ï¼ˆä¸¥æ ¼æ¨¡å¼æŠ¥é”™ï¼‰
obj.b = 3; // é™é»˜å¤±è´¥
console.log(obj.a); // 1
```

### 2.3 åŸå‹é“¾ â­â­â­

> **æ ¸å¿ƒè§‚ç‚¹**ï¼šJavaScript æ²¡æœ‰çœŸæ­£çš„"ç±»"ï¼ŒåŸå‹é“¾çš„æœ¬è´¨æ˜¯**å§”æ‰˜**è€Œé**å¤åˆ¶**ã€‚

| ä¼ ç»Ÿç±»è¯­è¨€           | JavaScript                   |
| -------------------- | ---------------------------- |
| ç»§æ‰¿ = å¤åˆ¶          | åŸå‹ = å§”æ‰˜                  |
| ä¿®æ”¹ç±»ä¸å½±å“å·²æœ‰å®ä¾‹ | ä¿®æ”¹åŸå‹ç«‹å³å½±å“æ‰€æœ‰å…³è”å¯¹è±¡ |

**ES6 `class` æ˜¯è¯­æ³•ç³–**ï¼šåº•å±‚ä¾ç„¶æ˜¯åŸå‹é“¾æ¥ï¼Œä¸æ˜¯çœŸæ­£çš„ç±»ç»§æ‰¿ã€‚

### 2.4 OLOO æ¨¡å¼ â­â­

**Objects Linked to Other Objects**ï¼šç›´æ¥åˆ©ç”¨å¯¹è±¡å§”æ‰˜ï¼Œé¿å¼€
`prototype`/`new`/`constructor` çš„å¤æ‚æ€§ã€‚

```javascript
const Task = {
  setID(ID) {
    this.id = ID;
  },
  outputID() {
    console.log(this.id);
  },
};

const XYZ = Object.create(Task); // XYZ å§”æ‰˜ Task
XYZ.prepareTask = function (ID, Label) {
  this.setID(ID); // å§”æ‰˜è°ƒç”¨
  this.label = Label;
};
```

---

## ä¸‰ã€ç±»å‹ä¸è¯­æ³• â­â­â­

**æ ¸å¿ƒè§‚ç‚¹**ï¼šå¼ºåˆ¶ç±»å‹è½¬æ¢ä¸æ˜¯è®¾è®¡ç¼ºé™·ï¼Œè€Œæ˜¯æ ¸å¿ƒç‰¹æ€§ã€‚è§‰å¾—å®ƒå‘ï¼Œæ˜¯å› ä¸ºæ‹’ç»ç†è§£å®ƒã€‚

### 3.1 ä¸ƒç§å†…ç½®ç±»å‹ â­â­

`null`ã€`undefined`ã€`boolean`ã€`number`ã€`string`ã€`symbol`ã€`object`

- `typeof null === "object"` æ˜¯å†å²é—ç•™ Bug
- **å˜é‡æ²¡æœ‰ç±»å‹ï¼Œå€¼æ‰æœ‰ç±»å‹**

### 3.2 åŸç”Ÿå‡½æ•°ä¸å°è£…å¯¹è±¡ â­â­

åŸç”Ÿå‡½æ•°ï¼š`String()`ã€`Number()`ã€`Boolean()`ã€`Array()`ã€`Object()`ã€`Function()`ã€`RegExp()`ã€`Date()`ã€`Error()`ã€`Symbol()`

#### `[[Class]]` å†…éƒ¨å±æ€§

```javascript
Object.prototype.toString.call([1, 2]); // "[object Array]"
Object.prototype.toString.call(/regex/); // "[object RegExp]"
Object.prototype.toString.call(null); // "[object Null]"
Object.prototype.toString.call(undefined); // "[object Undefined]"
```

#### å°è£…ä¸æ‹†å° (Boxing/Unboxing)

```javascript
// è‡ªåŠ¨å°è£…ï¼šåŸå§‹å€¼è°ƒç”¨æ–¹æ³•æ—¶ï¼ŒJS è‡ªåŠ¨å°è£…æˆå¯¹è±¡
'abc'.length; // JS å†…éƒ¨: new String("abc").length â†’ 3

// æ‹†å°ï¼šè·å–å°è£…å¯¹è±¡çš„åŸå§‹å€¼
const s = new String('abc');
s.valueOf(); // "abc"
```

> **æœ€ä½³å®è·µ**ï¼šä¸è¦ç›´æ¥åˆ›å»ºå°è£…å¯¹è±¡ï¼ˆå¦‚ `new String("abc")`ï¼‰ï¼Œè®© JS è‡ªåŠ¨å¤„ç†ã€‚

### 3.3 æŠ½è±¡æ“ä½œ â­â­â­

| æ“ä½œ            | è¯´æ˜                                                      |
| --------------- | --------------------------------------------------------- |
| **ToString**    | éå­—ç¬¦ä¸² â†’ å­—ç¬¦ä¸²                                         |
| **ToNumber**    | `true`â†’`1`, `false`â†’`0`, `undefined`â†’`NaN`, `null`â†’`0`    |
| **ToBoolean**   | Falsy å€¼ï¼š`undefined`, `null`, `false`, `Â±0`, `NaN`, `""` |
| **ToPrimitive** | å¯¹è±¡ â†’ åŸå§‹å€¼ï¼Œå…ˆ `valueOf()` å† `toString()`             |

#### JSON.stringify çš„ç‰¹æ®Šå¤„ç†

```javascript
JSON.stringify(undefined); // undefinedï¼ˆæ— è¾“å‡ºï¼‰
JSON.stringify(function () {}); // undefinedï¼ˆæ— è¾“å‡ºï¼‰
JSON.stringify([1, undefined, 2]); // "[1,null,2]"ï¼ˆæ•°ç»„ä¸­å˜ nullï¼‰
JSON.stringify({ a: undefined, b: 1 }); // "{\"b\":1}"ï¼ˆå¯¹è±¡ä¸­è¢«å¿½ç•¥ï¼‰
```

**è‡ªå®šä¹‰åºåˆ—åŒ–**ï¼šå®šä¹‰ `toJSON()` æ–¹æ³•æ§åˆ¶å¯¹è±¡å¦‚ä½•è¢«åºåˆ—åŒ–ã€‚

### 3.4 `==` vs `===` â­â­â­

**å¸¸è§è¯¯è§£**ï¼š`==` æ£€æŸ¥å€¼ï¼Œ`===` æ£€æŸ¥å€¼å’Œç±»å‹ã€‚

**çœŸç›¸**ï¼šä¸¤è€…éƒ½æ£€æŸ¥ç±»å‹ï¼ŒåŒºåˆ«æ˜¯ `==` å…è®¸å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œ`===` ä¸å…è®¸ã€‚

**å®ç”¨æŠ€å·§**ï¼š

```javascript
// ä¼˜é›…åœ°åˆ¤æ–­ null æˆ– undefined
if (a == null) {
  /* ç›¸å½“äº a === null || a === undefined */
}
```

**é¿å‘åŸåˆ™**ï¼šä¸è¦åœ¨ `==` ä¸€ä¾§ä½¿ç”¨ `true/false` æˆ– `[]/""/0`ã€‚

### 3.5 è¯­æ³•ç»†èŠ‚ â­â­

- **çŸ­è·¯é€»è¾‘**ï¼š`a && b` è¿”å›çš„ä¸æ˜¯å¸ƒå°”å€¼ï¼Œè€Œæ˜¯ `a` æˆ– `b` çš„å€¼
- **è¿ç­‰å·é™·é˜±**ï¼š`var a = b = 42;` ä¸­ `b` ä¼šå˜æˆå…¨å±€å˜é‡

#### ASI (è‡ªåŠ¨åˆ†å·æ’å…¥) â­â­

JS ä¼šåœ¨æŸäº›æƒ…å†µä¸‹è‡ªåŠ¨æ’å…¥åˆ†å·ï¼š

```javascript
// å±é™©æƒ…å†µ
return;
{
  a: 1;
}
// è¢«è§£æä¸º: return; { a: 1 }; è¿”å› undefinedï¼

// æ­£ç¡®å†™æ³•
return {
  a: 1,
};
```

**è§„åˆ™**ï¼šæ¢è¡Œç¬¦åå¦‚æœé‡åˆ° `)`ã€`]`ã€`}`ï¼Œæˆ–è€…æ˜¯
`return`ã€`throw`ã€`break`ã€`continue` åçš„æ¢è¡Œï¼Œä¼šè‡ªåŠ¨æ’å…¥åˆ†å·ã€‚

---

## å››ã€å¼‚æ­¥ä¸æ€§èƒ½ â­â­â­

**æ ¸å¿ƒè§‚ç‚¹**ï¼šå¼‚æ­¥çš„æœ¬è´¨ä¸æ˜¯è®©ç¨‹åºæ›´å¿«ï¼Œè€Œæ˜¯å¤„ç†"ç°åœ¨"ä¸"å°†æ¥"ä¹‹é—´çš„é¸¿æ²Ÿã€‚

### 4.1 äº‹ä»¶å¾ªç¯ (Event Loop) â­â­â­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      JS å¼•æ“ (å•çº¿ç¨‹)        â”‚
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    æ‰§è¡Œå½“å‰ä»»åŠ¡      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚             â”‚               â”‚
â”‚             â–¼               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  æ£€æŸ¥ä»»åŠ¡é˜Ÿåˆ—        â”‚â—„â”€â”€â”€â”€â”€ å®¿ä¸»ç¯å¢ƒå°†å¼‚æ­¥å›è°ƒæ”¾å…¥é˜Ÿåˆ—
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç»“è®º**ï¼šJS çš„å¼‚æ­¥ä¸æ˜¯çœŸæ­£çš„å¹¶è¡Œï¼Œè€Œæ˜¯"åˆ†å—æ‰§è¡Œ"ã€‚

### 4.2 å›è°ƒçš„ä¿¡ä»»é—®é¢˜ â­â­â­

**å›è°ƒåœ°ç‹±çš„æœ¬è´¨**ï¼šä¸æ˜¯åµŒå¥—æ·±ï¼Œè€Œæ˜¯**æ§åˆ¶åè½¬** (Inversion of Control)ã€‚

ä½ æŠŠç¨‹åºæ‰§è¡Œæƒäº¤ç»™äº†ç¬¬ä¸‰æ–¹ï¼Œæ— æ³•ä¿è¯ï¼š

- ä¸ä¼šè¢«å¤šæ¬¡è°ƒç”¨
- ä¸ä¼šä¸è¢«è°ƒç”¨
- ä¸ä¼šåæ‰é”™è¯¯

### 4.3 Promise â­â­â­

> **æ¯”å–»**ï¼šPromise æ˜¯"å–é¤å·"ï¼Œä»£è¡¨ä¸€ä¸ªæœªæ¥ä¼šæ‹¿åˆ°çš„å€¼ã€‚

**è§£å†³ä¿¡ä»»é—®é¢˜**ï¼š

1. **ä¸å¯å˜æ€§**ï¼šçŠ¶æ€ä¸€æ—¦ç¡®å®šå°±ä¸å¯æ›´æ”¹
2. **é”™è¯¯ä¼ æ’­**ï¼šå¼‚å¸¸æ²¿é“¾æ¡ä¼ é€’ï¼Œä¸ä¼šè¢«åæ‰
3. **æ§åˆ¶æƒå›å½’**ï¼šç”±ä½ å†³å®šä½•æ—¶æ‰§è¡Œ `.then()`

#### Promise ç»„åˆæ–¹æ³• â­â­â­

```javascript
// Promise.all - å…¨éƒ¨æˆåŠŸæ‰æˆåŠŸï¼Œä¸€ä¸ªå¤±è´¥å°±å¤±è´¥
Promise.all([p1, p2, p3])
  .then(([r1, r2, r3]) => console.log('å…¨éƒ¨å®Œæˆ'))
  .catch((err) => console.log('æœ‰ä¸€ä¸ªå¤±è´¥'));

// Promise.race - ç¬¬ä¸€ä¸ªå®Œæˆçš„å†³å®šç»“æœ
Promise.race([p1, p2]).then((first) => console.log('æœ€å¿«çš„ç»“æœ'));

// Promise.allSettled - ç­‰å¾…å…¨éƒ¨å®Œæˆï¼Œæ— è®ºæˆåŠŸå¤±è´¥
Promise.allSettled([p1, p2]).then((results) =>
  results.forEach((r) => console.log(r.status)),
);

// Promise.any - ç¬¬ä¸€ä¸ªæˆåŠŸçš„ï¼Œå…¨éƒ¨å¤±è´¥æ‰å¤±è´¥
Promise.any([p1, p2]).then((first) => console.log('ç¬¬ä¸€ä¸ªæˆåŠŸçš„'));
```

### 4.4 Generator â­â­

è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ï¼š

```javascript
function* main() {
  try {
    const result = yield request('http://api.example.com');
    console.log(result);
  } catch (err) {
    console.error(err);
  }
}
```

**ç»ˆæç»„åˆ**ï¼šGeneratorï¼ˆæµç¨‹æ§åˆ¶ï¼‰+ Promiseï¼ˆå¼‚æ­¥äº¤ä»˜ï¼‰= `async/await` çš„å‰èº«

### 4.5 Web Workers â­â­

åœ¨ç‹¬ç«‹çº¿ç¨‹ä¸­è¿è¡Œ JSï¼Œå¤„ç†è€—æ—¶è®¡ç®—è€Œä¸é˜»å¡ UIï¼š

```javascript
// ä¸»çº¿ç¨‹
const worker = new Worker('worker.js');
worker.postMessage({ data: 'heavy task' });
worker.onmessage = (e) => console.log(e.data);

// worker.js
onmessage = (e) => {
  const result = heavyComputation(e.data);
  postMessage(result);
};
```

**é™åˆ¶**ï¼šæ— æ³•è®¿é—® DOMï¼Œä¸ä¸»çº¿ç¨‹é€šè¿‡æ¶ˆæ¯ä¼ é€’é€šä¿¡ã€‚

### 4.6 å¾®ä»»åŠ¡ vs å®ä»»åŠ¡ â­â­â­

| ç±»å‹       | ç¤ºä¾‹                               | ä¼˜å…ˆçº§ |
| ---------- | ---------------------------------- | ------ |
| **å¾®ä»»åŠ¡** | `Promise.then`, `MutationObserver` | é«˜     |
| **å®ä»»åŠ¡** | `setTimeout`, `setInterval`, I/O   | ä½     |

```javascript
console.log('1'); // åŒæ­¥
setTimeout(() => console.log('2'), 0); // å®ä»»åŠ¡
Promise.resolve().then(() => console.log('3')); // å¾®ä»»åŠ¡
console.log('4'); // åŒæ­¥
// è¾“å‡ºé¡ºåº: 1 â†’ 4 â†’ 3 â†’ 2
```

---

## äº”ã€ES6+ ä¸å…ƒç¼–ç¨‹ â­â­â­

**æ ¸å¿ƒè§‚ç‚¹**ï¼šES6 æ˜¯èŒƒå¼è½¬å˜ï¼Œèµ‹äºˆå¼€å‘è€…"ä¿®æ”¹è¯­è¨€åº•å±‚è¡Œä¸º"çš„èƒ½åŠ›ã€‚

### 5.1 let/const ä¸ TDZ â­â­â­

#### æš‚æ—¶æ€§æ­»åŒº (Temporal Dead Zone)

```javascript
console.log(a); // ReferenceError: Cannot access 'a' before initialization
let a = 1;

// å¯¹æ¯” var
console.log(b); // undefinedï¼ˆå·²æå‡ï¼‰
var b = 2;
```

**TDZ è§„åˆ™**ï¼š`let`/`const` å£°æ˜çš„å˜é‡åœ¨å£°æ˜ä¹‹å‰çš„åŒºåŸŸç§°ä¸º TDZï¼Œè®¿é—®ä¼šæŠ¥é”™ã€‚

### 5.2 è§£æ„ä¸å±•å¼€è¿ç®—ç¬¦ â­â­â­

#### è§£æ„èµ‹å€¼

```javascript
// å¯¹è±¡è§£æ„
const { a, b: renamed, c = 'default' } = obj;

// æ•°ç»„è§£æ„
const [first, , third] = arr;

// åµŒå¥—è§£æ„
const {
  user: { name },
} = response;
```

#### å±•å¼€/å‰©ä½™è¿ç®—ç¬¦

```javascript
// å±•å¼€æ•°ç»„
const arr = [1, 2, 3];
console.log(...arr); // 1 2 3
const merged = [...arr1, ...arr2];

// å±•å¼€å¯¹è±¡
const merged = { ...obj1, ...obj2 };

// å‰©ä½™å‚æ•°
function sum(...nums) {
  return nums.reduce((a, b) => a + b, 0);
}
```

### 5.3 Symbolï¼šè¯­è¨€åº•å±‚çš„é’©å­ â­â­

| Well-known Symbol    | ä½œç”¨                       |
| -------------------- | -------------------------- |
| `Symbol.iterator`    | ä½¿å¯¹è±¡å¯è¢« `for...of` éå† |
| `Symbol.toPrimitive` | è‡ªå®šä¹‰ç±»å‹è½¬æ¢è¡Œä¸º         |
| `Symbol.hasInstance` | é‡å®šä¹‰ `instanceof` é€»è¾‘   |

### 5.4 Proxy & Reflect â­â­â­

**Proxy**ï¼šåœ¨ç›®æ ‡å¯¹è±¡å‰æ¶è®¾æ‹¦æˆªå±‚ï¼Œå¯æ‹¦æˆª `get`/`set`/`deleteProperty`/`apply`
ç­‰æ“ä½œã€‚

```javascript
const handler = {
  get(target, prop) {
    console.log(`è¯»å– ${prop}`);
    return Reflect.get(target, prop);
  },
};
const proxy = new Proxy({}, handler);
```

**å®æˆ˜æ„ä¹‰**ï¼šVue 3 å“åº”å¼ç³»ç»Ÿçš„æ ¸å¿ƒã€‚

**Reflect**ï¼šæ ‡å‡†åŒ–åº•å±‚æ“ä½œï¼Œä¸ Proxy é…åˆä½¿ç”¨ã€‚

### 5.5 æ–°æ•°æ®ç»“æ„ â­â­

#### Map vs Object

```javascript
const map = new Map();
map.set('key', 'value');
map.set({}, 'object key'); // å¯ä»¥ç”¨å¯¹è±¡ä½œä¸ºé”®
map.get('key'); // 'value'
map.size; // 2
```

| ç‰¹æ€§   | Object              | Map        |
| ------ | ------------------- | ---------- |
| é”®ç±»å‹ | åªèƒ½æ˜¯å­—ç¬¦ä¸²/Symbol | ä»»æ„ç±»å‹   |
| é”®é¡ºåº | æ— ä¿è¯              | æ’å…¥é¡ºåº   |
| å¤§å°   | æ‰‹åŠ¨è®¡ç®—            | `map.size` |
| è¿­ä»£   | éœ€è½¬æ¢              | ç›´æ¥è¿­ä»£   |

#### Set

```javascript
const set = new Set([1, 2, 2, 3]);
console.log([...set]); // [1, 2, 3]ï¼ˆè‡ªåŠ¨å»é‡ï¼‰
set.has(2); // true
```

#### WeakMap/WeakSet

- é”®å¿…é¡»æ˜¯å¯¹è±¡
- å¼±å¼•ç”¨ï¼Œä¸é˜»æ­¢åƒåœ¾å›æ”¶
- å¸¸ç”¨äºç§æœ‰æ•°æ®å­˜å‚¨

### 5.6 è¿­ä»£å™¨åè®® â­â­

- **Iterator**ï¼šè§„å®šæ•°æ®å¦‚ä½•è¢«"æ¶ˆè´¹"
- **Iterable**ï¼šå®šä¹‰ `Symbol.iterator` ä½¿ä»»ä½•æ•°æ®ç»“æ„å¯è¢«éå†

### 5.7 async/await â­â­â­

**æé†’**ï¼šè™½ç„¶è¯­æ³•åƒåŒæ­¥ï¼Œä½†åº•å±‚ä¾ç„¶æ˜¯ Promiseï¼Œä¸è¦å¿˜è®°å¼‚æ­¥æœºåˆ¶ã€‚

```javascript
// å¹¶è¡Œæ‰§è¡Œï¼ˆæ¨èï¼‰
const [a, b] = await Promise.all([fetchA(), fetchB()]);

// ä¸²è¡Œæ‰§è¡Œï¼ˆè¾ƒæ…¢ï¼‰
const a = await fetchA();
const b = await fetchB();
```

---

## æ€»ç»“

| ç¯‡ç«      | æ ¸å¿ƒä¸»é¢˜     | å…³é”®è¯                                  | é‡è¦æ€§ |
| -------- | ------------ | --------------------------------------- | ------ |
| **ä¸Šå·** | ä½œç”¨åŸŸä¸é—­åŒ… | è¯æ³•ä½œç”¨åŸŸã€æå‡ã€é—­åŒ…ã€æ¨¡å—æ¨¡å¼        | â­â­â­ |
| **ä¸Šå·** | this ä¸åŸå‹  | å››ç§ç»‘å®šã€åŸå‹å§”æ‰˜ã€OLOO                | â­â­â­ |
| **ä¸­å·** | ç±»å‹ä¸è¯­æ³•   | æŠ½è±¡æ“ä½œã€å¼ºåˆ¶è½¬æ¢ã€`==`ã€ASI           | â­â­â­ |
| **ä¸­å·** | å¼‚æ­¥ä¸æ€§èƒ½   | Event Loopã€Promiseã€å¾®ä»»åŠ¡/å®ä»»åŠ¡      | â­â­â­ |
| **ä¸‹å·** | ES6+         | let/constã€è§£æ„ã€Symbolã€Proxyã€Map/Set | â­â­â­ |
