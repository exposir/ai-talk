<!--
- [INPUT]: 依赖 notes/antigravity/CLAUDE.md 的模块定位与索引
- [OUTPUT]: 输出 开发模式详解 文档
- [POS]: 位于 notes/antigravity 模块的 开发模式详解 笔记
- [PROTOCOL]: 变更时更新此头部，然后检查 CLAUDE.md
-->

# 开发模式详解

Antigravity 提供三种开发模式，适应不同场景需求。

---

## Agent-driven 模式（自动驾驶）

### 特点

- Agent 完全自主执行
- 自动创建文件、运行命令
- 最少人工干预

### 工作流程

```
用户提示 → Agent 规划 → 自动执行 → 完成报告
           ↓
        无需确认
```

### 适用场景

| 场景         | 原因             |
| ------------ | ---------------- |
| 新项目初始化 | 快速搭建基础结构 |
| 原型开发     | 快速验证想法     |
| 简单功能添加 | 明确需求无需讨论 |
| 代码生成任务 | 模板化工作       |

### 风险提示

⚠️ Agent 可能执行破坏性操作：

- 删除文件
- 修改配置
- 安装依赖

建议：使用 Git 版本控制，便于回滚。

---

## Review-driven 模式（审核模式）

### 特点

- 每个操作需要用户批准
- 完全透明的决策过程
- 最大程度人工控制

### 工作流程

```
用户提示 → Agent 规划 → 展示计划
                         ↓
                    用户审核批准
                         ↓
                    执行单步操作
                         ↓
                    展示结果
                         ↓
                    继续/修改？
```

### 适用场景

| 场景         | 原因               |
| ------------ | ------------------ |
| 生产环境代码 | 需要严格审查       |
| 学习 Agent   | 理解决策过程       |
| 复杂重构     | 逐步验证每个更改   |
| 敏感操作     | 数据库、API 密钥等 |

### 操作提示

- `y` / `Enter`: 批准执行
- `n`: 拒绝并说明原因
- `e`: 编辑后执行
- `q`: 退出任务

---

## Agent-assisted 模式（推荐）

### 特点

- 安全操作自动执行
- 风险操作需要确认
- 平衡效率与控制

### 工作流程

```
用户提示 → Agent 规划
              ↓
         ┌────┴────┐
    安全操作      风险操作
         ↓            ↓
    自动执行      请求批准
         ↓            ↓
         └────┬────┘
              ↓
           汇报结果
```

### 安全操作（自动执行）

- 读取文件
- 代码分析
- 生成计划
- 创建新文件
- 格式化代码

### 风险操作（需要确认）

- 删除文件
- 修改现有代码
- 执行 shell 命令
- 安装依赖
- 网络请求

### 自定义安全规则

在设置中配置允许/禁止列表：

```json
{
  "permissions": {
    "allow": ["Bash(npm run:*)", "Bash(git status)", "Write(src/**/*.tsx)"],
    "deny": ["Bash(rm -rf *)", "Write(.env*)", "Read(secrets/**)"]
  }
}
```

---

## 模式切换

### 快捷方式

- 使用 `Shift+Tab` 循环切换模式
- 或在设置面板中选择

### 临时覆盖

在提示词中指定：

```
【使用 Review-driven 模式】
重构数据库连接逻辑
```

### 任务级别设置

```
创建用户认证模块
---
mode: agent-driven
```

---

## 模式对比

| 特性   | Agent-driven | Review-driven | Agent-assisted |
| ------ | ------------ | ------------- | -------------- |
| 速度   | ⚡ 最快      | 🐢 最慢       | 🚀 适中        |
| 控制   | ❌ 最少      | ✅ 完全       | ⚖️ 平衡        |
| 风险   | ⚠️ 较高      | ✅ 最低       | ⚖️ 可控        |
| 适合   | 新手/原型    | 学习/敏感     | 日常开发       |
| 推荐度 | ⭐⭐         | ⭐⭐⭐        | ⭐⭐⭐⭐⭐     |

---

## 最佳实践

1. **日常开发**：使用 Agent-assisted
2. **快速原型**：使用 Agent-driven
3. **代码审查**：切换到 Review-driven
4. **敏感操作**：始终使用 Review-driven
5. **版本控制**：任何模式都要用 Git
