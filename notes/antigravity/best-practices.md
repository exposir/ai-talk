# Antigravity 最佳实践

高效使用 Antigravity 的经验总结。

---

## 一、任务规划

### 1.1 先计划后执行

```
【Plan 模式】
分析这个需求，创建实现计划，不要开始编码：

需要实现用户认证系统，包含：
- 登录/注册/找回密码
- JWT Token 管理
- 权限控制
```

### 1.2 分解大任务

❌ 错误做法：

```
创建一个完整的电商网站
```

✅ 正确做法：

```
Phase 1: 创建商品列表页面
Phase 2: 实现购物车功能
Phase 3: 添加结算流程
...
```

### 1.3 使用 Artifacts 追踪

始终让 Agent 维护 `task.md`，清晰了解进度。

---

## 二、提示词技巧

### 2.1 提供上下文

```
根据现有代码风格创建新组件：
@src/components/Button.tsx
@src/components/Card.tsx

新建: ProductCard 组件
```

### 2.2 具体明确

❌ 模糊：

```
改进这个页面
```

✅ 具体：

```
优化首页性能：
- 图片懒加载
- 组件代码分割
- 减少首屏 JS 大小
```

### 2.3 指定约束

```
重构用户模块：
- 保持 API 接口不变
- 不修改数据库结构
- 需要向后兼容
```

---

## 三、开发模式选择

| 场景       | 推荐模式       |
| ---------- | -------------- |
| 新项目搭建 | Agent-driven   |
| 日常开发   | Agent-assisted |
| 敏感代码   | Review-driven  |
| 学习理解   | Review-driven  |

### 3.1 切换时机

- 开始新功能 → Agent-driven 生成基础结构
- 细节调整 → Agent-assisted 迭代
- 上线发布前 → Review-driven 审查

---

## 四、浏览器测试

### 4.1 开发过程中测试

```
运行开发服务器并打开浏览器：
1. npm run dev
2. 浏览器访问 localhost:3000
3. 测试登录功能
4. 截图保存结果
```

### 4.2 响应式验证

```
检查页面在以下分辨率的显示：
- 1920x1080 (桌面)
- 768x1024 (平板)
- 375x667 (手机)
```

---

## 五、版本控制

### 5.1 频繁提交

让 Agent 在每个阶段提交：

```
完成用户登录功能后，提交到 Git：
- message: feat: implement user login
```

### 5.2 分支策略

```
创建新分支 feature/user-auth
在分支上开发用户认证功能
```

### 5.3 回滚能力

Agent-driven 模式有风险，确保可以回滚：

```
如果出错，回滚到上一个提交
```

---

## 六、代码质量

### 6.1 要求测试

```
创建 UserService，包含单元测试
```

### 6.2 类型安全

```
使用 TypeScript strict 模式
禁止使用 any 类型
```

### 6.3 代码审查

```
【Review 模式】
审查刚才生成的代码：
- 检查潜在 bug
- 性能问题
- 安全隐患
```

---

## 七、Multi-Agent 协作

### 7.1 任务分工

```
Workspace 1: 前端开发
Workspace 2: 后端 API
Workspace 3: 数据库设计
```

### 7.2 串行依赖

```
先完成 API 设计（Workspace 2）
然后前端调用 API（Workspace 1）
```

---

## 八、常见问题处理

### 8.1 Agent 陷入循环

```
/stop
重新描述需求，更加具体
```

### 8.2 生成代码质量差

```
提供更多参考代码：
@src/existing-component/

按照这个风格重新生成
```

### 8.3 上下文丢失

```
复杂项目使用多个 task.md 分模块记录状态
```

---

## 九、效率提升

### 9.1 模板化

创建常用任务模板：

```
# 新建 Feature 模板
1. 创建 feature 目录结构
2. 添加类型定义
3. 创建 API 服务
4. 创建 UI 组件
5. 添加单元测试
```

### 9.2 预设规则

在设置中配置项目规则：

```json
{
  "rules": {
    "codeStyle": "prettier",
    "testFramework": "vitest",
    "componentStyle": "functional"
  }
}
```

### 9.3 快捷键

| 快捷键        | 功能          |
| ------------- | ------------- |
| `Cmd+Shift+A` | Agent Manager |
| `Cmd+Enter`   | 发送提示      |
| `Shift+Tab`   | 切换模式      |

---

## 十、核心原则

1. **规划优先** - 复杂任务先 Plan
2. **分而治之** - 大任务拆小任务
3. **上下文充分** - 提供足够参考
4. **频繁验证** - 小步快跑
5. **版本控制** - 始终用 Git
6. **质量保证** - 要求测试
